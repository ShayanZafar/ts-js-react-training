import { FullScreenCode, Split, SplitRight, Invert } from "mdx-deck/layouts";
import { Head, Appear, Image, withDeck } from 'mdx-deck'
import { CodeSurfer } from "mdx-deck-code-surfer"
import nightOwl from "prism-react-renderer/themes/nightOwl"

import ReplIt from "../../components/ReplIt";
import CodeSandbox from "../../components/CodeSandbox";
import ImageSplit from "../../components/ImageSplit";
import Box from "../../components/Box";
const BRANCH_NAME = 'es-april-22-update'; // tood: change before merge

export default Invert

# useEffect 

---

## `useEffect` Hook

- Can replace componentWillUpdate + componentDidMount
- Used to manage side effects, such as DOM updates, API calls
- Can specify what values the effect relies on, and only update when they change
- Like setState, can be used multiple times in one component


---

## `useEffect` - Specifying Data Dependencies

- useEffect by default will run on every render
- If you specify an empty array - it will only run the unitial render 
- If you specify the values it depends on in the array - it will run when those values change

---

## `useEffect` - Specifying Data Dependencies - Example 

<Box width={'80vw'}>
    <CodeSandbox src={`https://codesandbox.io/embed/github/e-schultz/ts-js-react-training/tree/${BRANCH_NAME}/examples/react-hooks-useEffect-01?autoresize=1&codemirror=1&fontsize=14&module=%2Fsrc%2Findex.js`}/>
</Box>

---

<CodeSurfer
  code={require("!raw-loader!./snippets/hooks-vs-classes-1.snippet")}
  theme={nightOwl}
  lang="jsx"
  title="Search Component - Class"
  showNumbers
  steps={[
    {}, // A component that handles a search
    {lines: [6], notes: "User will enter a search term"},
    {lines: [7], notes: "We will search and store results"},
    {lines: [11], notes: "We need to get initial results for default search"},
    {lines: [20], notes: "But we also need to get results when component updates"},
    {lines: [12,13,14,15,16,22,23,24,25,26], notes: "Code can be refactored, but winds up duplicated"},
    {lines: [21], notes: "A check is needed to avoid too many API calls"},
    {}
  ]}
/>

---

<CodeSurfer
  code={require("!raw-loader!./snippets/hooks-vs-classes-2.snippet")}
  theme={nightOwl}
  lang="jsx"
  title="Search Component - Class"
  showNumbers
  steps={[
    {}, // A component that handles a search
    {range: [3, 13], notes: "Much less code needed for the same result"},
    {lines: [1], notes: "Import the hooks we want to use"},
    {lines: [4,5], notes: "Create stateful variables and their setters with useState"},
    {lines: [4], notes: "Access with searchTerm, set with setSearchTerm()"},
    {lines: [4,5], notes: "Provide default values of 'news' and []"},
    {lines: [7], notes: "useEffect will run when component mounts OR updates"},
    {range: [7,12], notes: "API request in one spot"},
    {lines: [12], notes: "This effect only runs when searchTerm changes"},
    {}
  ]}
/>

---

### Exercise: Refactor Data Search to use `useEffect` - Start

<Box width={'80vw'}>
    <CodeSandbox src={`https://codesandbox.io/embed/github/e-schultz/ts-js-react-training/tree/${BRANCH_NAME}/exercises/react-hook-refactor-data-fetch-use-effect-start?autoresize=1&codemirror=1&fontsize=14&module=%2FREADME.md`}/>
</Box>

---

### Exercise: Refactor Data Search to use `useEffect` - Solution

<Box width={'80vw'}>
    <CodeSandbox src={`https://codesandbox.io/embed/github/e-schultz/ts-js-react-training/tree/${BRANCH_NAME}/exercises/react-hook-refactor-data-fetch-use-effect-end?autoresize=1&codemirror=1&fontsize=14&module=%2Fsrc%2FApp.js`}/>
</Box>

---

# [More on Hooks](https://reactjs.org/docs/hooks-intro.html)